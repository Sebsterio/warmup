/*! warmup v0.0.1 | (c) 2020 Sebastian Rosloniec | ISC License | git+https://github.com/Sebsterio/warmup.git */
!(function(){const e=document.querySelector(".house"),t=e.querySelectorAll(".house__media"),{disableVideo:n,disableImages:i,disableYTEmbeds:r,forceYTEmbeds:o,YT_PARAMS:a,interval:c}=houseConfig,{allMedia:d}=houseState;let l=[],u=[];const s=[...t].map(e=>({element:e,mediaId:null,mediaType:null}));function f(){(l=d.filter(e=>{const t=s.find(t=>t.mediaId===e.id),n=u.includes(e.id);if(!t&&!n)return e})).length||(l=[...d])}function m({link:e,type:t,ratio:n},i){switch(t){case"video":return (function(e){return`<video class="video" autoplay muted loop src="${e}"></video>`})(e);case"image":return (function(e){return`<img class="image" src="${e}" alt=":)">`})(e);case"YT embed":return createYTEmbed(e,n,i);default:return""}}function h(e){if("video"===e&&!n)return!0;if("image"===e&&!i)return!0;if("YT embed"===e){if(o)return!0;if(!r&&window.innerWidth>800)return!0}return!1}function p(e){let t=!1;for(;!t;){l.length||f();const n=Math.floor(Math.random()*l.length),i=l.splice(n,1)[0],{type:r,id:o}=i;if(h(r)){const n=e.element;n.innerHTML=m(i,n),e.mediaId=o,e.mediaType=r,t=!0}else u.push(o)}}window.createYTEmbed=function(e,t,n){const i=Math.ceil(n.offsetHeight);if(!i)throw new Error("YT embed error: invalid container");t||(t=1.8);const r=e.split("?"),o=r[0].replace("https://www.youtube.com/embed/","").match(/[^\?\/]+/),c=a+"&playlist="+o;return`<div class="embed"><iframe\n\t\t\tdata-ratio="${t}"\n\t\t\twidth="${i*t}px"\n\t\t\theight="${i}px"\n\t\t\tsrc="${r[0]+c}"\n\t\t\tframeborder="0"\n\t\t\tallow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"\n\t\t></iframe></div>`},window.houseFirestore.fetch((function(t){d.push(...t),f(),d.length&&s.forEach(e=>p(e)),(function(){if(0===Number(c))return;let e=Math.floor(Math.random()*s.length);setInterval(()=>{p(s[e]),e=e<s.length-1?e+1:0},Number(c))})(),e.querySelectorAll("video").forEach((e,t)=>{e.currentTime+=5*t})})),window.addEventListener("resize",(function(){s.forEach(e=>{const t=e.element,n=t.querySelector("iframe");if(!n)return;const i=Math.ceil(t.offsetHeight),r=n.dataset.ratio;n.width=i*r,n.height=i})}))})();