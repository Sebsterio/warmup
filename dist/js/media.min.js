/*! warmup v0.0.1 | (c) 2020 Sebastian Rosloniec | ISC License | git+https://github.com/Sebsterio/warmup.git */
!(function(){const e=document.querySelector(".house"),t=e.querySelectorAll(".house__media"),{disableVideo:i,disableImages:r,disableYTEmbeds:n,forceYTEmbeds:o,YT_PARAMS:a,interval:d,ignorePriority:c,ignorePinned:l}=houseConfig,{allMedia:u}=houseState;let s=[],f=[];const m=[...t].map(e=>({element:e,media:void 0}));function h(){(s=u.filter(e=>{const t=m.find(t=>!!t.media&&t.media.id===e.id),i=f.includes(e.id);if(!t&&!i)return e})).length||(s=[...u])}function p({type:e,priority:t},a){if("priority-only"===a&&!t)return!1;if("video"===e&&!i)return!0;if("image"===e&&!r)return!0;if("YT embed"===e){if(o)return!0;if(!n&&window.innerWidth>800)return!0}return!1}function g(e,t){e.media=(function(e){for(;f.length<u.length;){s.length||h();const t=Math.floor(Math.random()*s.length),i=s.splice(t,1)[0];if(p(i,e))return i;f.push(i.id)}})(t),e.media&&(e.element.innerHTML=(function({link:e,type:t,ratio:i},r){switch(t){case"video":return (function(e){return`<video class="video" autoplay muted loop src="${e}"></video>`})(e);case"image":return (function(e){return`<img class="image" src="${e}" alt=":)">`})(e);case"YT embed":return createYTEmbed(e,i,r);default:return""}})(e.media,e.element))}window.createYTEmbed=function(e,t,i){const r=Math.ceil(i.offsetHeight);if(!r)throw new Error("YT embed error: invalid container");t||(t=1.8);const n=e.split("?")[0],o=n.replace("https://www.youtube.com/embed/","").match(/[^\?\/]+/);return`<div class="embed"><iframe\n\t\t\tdata-ratio="${t}"\n\t\t\twidth="${r*t}px"\n\t\t\theight="${r}px"\n\t\t\tsrc="${n+(a+"&playlist="+o)}"\n\t\t\tframeborder="0"\n\t\t\tallow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"\n\t\t></iframe></div>`},window.houseFirestore.fetch((function(t){u.push(...t),h(),u.length&&(c||(m.forEach(e=>g(e,"priority-only")),f=[],h()),m.forEach(e=>{e.media||g(e)})),(function(){if(0===Number(d))return;let e=Math.floor(Math.random()*m.length);setInterval(()=>{const t=m[e];(l||t.media&&!t.media.pinned)&&g(t),e=e<m.length-1?e+1:0},Number(d))})(),e.querySelectorAll("video").forEach((e,t)=>{e.currentTime+=5*t})})),window.addEventListener("resize",(function(){m.forEach(e=>{const t=e.element,i=t.querySelector("iframe");if(!i)return;const r=Math.ceil(t.offsetHeight),n=i.dataset.ratio;i.width=r*n,i.height=r})}))})();