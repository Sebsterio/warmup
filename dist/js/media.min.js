/*! warmup v0.0.1 | (c) 2020 Sebastian Rosloniec | ISC License | git+https://github.com/Sebsterio/warmup.git */
!(function(){const e=document.querySelector(".house"),t=e.querySelectorAll(".house__media"),{disableVideo:n,disableImages:i,disableYTEmbeds:o,forceYTEmbeds:r,YT_PARAMS:a,interval:d,ignorePriority:c,ignorePinned:l}=houseConfig,{allMedia:u}=houseState;let s=[],m=[];const f=[...t].map(e=>({element:e,media:void 0}));function h(){(s=u.filter(e=>{const t=f.find(t=>!!t.media&&t.media.id===e.id),n=m.includes(e.id);if(!t&&!n)return e})).length||(s=[...u])}function p(e,t,n){if(!n)throw new Error("YT embed error: invalid container");const i=Math.ceil(n.offsetHeight);t||(t=1.8);const o=e.split("?")[0],r=o.replace("https://www.youtube.com/embed/","").match(/[^\?\/]+/);return`<div class="embed"><iframe\n\t\t\tdata-ratio="${t}"\n\t\t\twidth="${i*t}px"\n\t\t\theight="${i}px"\n\t\t\tsrc="${o+(a+"&playlist="+r)}"\n\t\t\tframeborder="0"\n\t\t\tallow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"\n\t\t></iframe></div>`}function w(e){return`<video class="video" autoplay muted loop src="${e}"></video>`}function g(e){return`<img class="image" src="${e}" alt=":)">`}function b(e,t){for(let n in t)if(t[n]!==e[n])return!1;const{type:a}=e;if("video"===a&&!n)return!0;if("image"===a&&!i)return!0;if("YT embed"===a){if(r)return!0;if(!o&&window.innerWidth>800)return!0}return!1}function v(e,t){e.media=(function(e){for(;m.length<u.length;){s.length||h();const t=Math.floor(Math.random()*s.length),n=s.splice(t,1)[0];if(b(n,e))return n;m.push(n.id)}})(t),e.media&&(function({link:e,type:t,ratio:n},i){"image"===t&&window.houseApp.preloadImage(e,()=>{i.innerHTML=g(e)}),"video"===t&&window.houseApp.preloadVideo(e,()=>{i.innerHTML=w(e)}),"YT embed"===t&&(i.innerHTML=p(e,n,i))})(e.media,e.element)}function y(){u.length&&(c||(f.forEach(e=>v(e,{priority:!0})),m=[],h()),f.forEach(e=>{e.media||v(e)}))}window.addEventListener("resize",(function(){f.forEach(e=>{const t=e.element,n=t.querySelector("iframe");if(!n)return;const i=Math.ceil(t.offsetHeight),o=n.dataset.ratio;n.width=i*o,n.height=i})})),window.houseApp.createYTEmbed=p,window.houseApp.createVideo=w,window.houseApp.createImage=g,window.houseApp.preloadImage=function(e,t){var n=new Image;n.src=e,n.onload=t},window.houseApp.preloadVideo=function(e,t){const n=document.createElement("video");n.src=e,n.onloadedmetadata=(()=>t())},window.houseApp.addCollection=function(){h(),y(),(function(){if(0===Number(d))return;let e=Math.floor(Math.random()*f.length);setInterval(()=>{const t=f[e];(l||t.media&&!t.media.pinned)&&v(t),e=e<f.length-1?e+1:0},Number(d))})(),e.querySelectorAll("video").forEach((e,t)=>{e.currentTime+=5*t})}})();