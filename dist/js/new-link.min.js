/*! warmup v0.0.1 | (c) 2020 Sebastian Rosloniec | ISC License | git+https://github.com/Sebsterio/warmup.git */
!(function(){const{profile:e}=window.houseConfig,t=document.querySelector(".house__panel--new-link form"),r=t.querySelector("#house__input--type"),o=t.querySelector("#house__input--ratio"),i=t.querySelector("[for=house__input--ratio]"),n=t.querySelector(".house__ratio-display"),u=t.querySelector("#house__input--url"),a=t.querySelector(".house__preview--media"),l=t.querySelector(".house__button--submit"),d=t.querySelectorAll(".house__preview-comment");function s(e){e?(o.removeAttribute("hidden"),i.removeAttribute("hidden")):(o.setAttribute("hidden",!0),i.setAttribute("hidden",!0))}function p(e){d.forEach(t=>{t.classList.contains("house__preview-comment--"+e)?t.removeAttribute("hidden"):t.setAttribute("hidden",!0)})}function c(){"YT embed"===t.type.value?(s(!0),p("embed")):(s(!1),p("source"))}function v(e){return e.replace(/[^]+src="/,"").replace(/"[^]+$/,"")}function h(e){e?(l.removeAttribute("disabled"),l.value="Add Love"):(l.setAttribute("disabled",!0),l.value="Link not valid")}r.addEventListener("input",c),o.addEventListener("input",(function(e){n.innerText=e.target.value})),u.addEventListener("input",(function(e){h(!1);let r=e.target.value;if("image"===t.type.value)window.houseApp.preloadImage(r,()=>{a.innerHTML=`<img src="${r}" alt="preview">`,h(!0)});else if("video"===t.type.value)window.houseApp.preloadVideo(r,()=>{a.innerHTML=`<video class="video" autoplay muted loop src="${r}"></video>`,h(!0)});else if("YT embed"===t.type.value){const e=v(r),o=t.ratio.value;a.innerHTML=window.createYTEmbed(e,o,a),h(!0)}})),t.addEventListener("submit",(function(r){r.preventDefault();const{allMedia:o}=window.houseState,i=(function(){const e={id:"_"+Math.random().toString(36).substr(2,9),type:t.type.value,description:t.description.value,link:t.url.value};return"YT embed"===t.type.value&&(e.link=v(t.url.value),e.ratio=t.ratio.value),e})();o.push(i),e||"woods"===prompt("Warm up in the ... ?")?houseApp.firestore.update(e,o,()=>{alert("Love shared succesfullly"),t.reset(),a.innerHTML=""}):alert("Sorry, wrong password. Feel free to create your own profile.")})),c()})();