/*! warmup v0.0.1 | (c) 2020 Sebastian Rosloniec | ISC License | git+https://github.com/Sebsterio/warmup.git */
!(function(){const{profile:e}=window.houseConfig,{firestore:t}=window.houseApp,i=document.querySelector(".house__panel--new-link form"),n=i.querySelector("#house__input--type"),o=i.querySelector("#house__input--ratio"),u=i.querySelector("[for=house__input--ratio]"),r=i.querySelector(".house__ratio-display"),l=i.querySelector("#house__input--url"),d=i.querySelector(".house__preview--media"),a=i.querySelector(".house__button--submit"),s=i.querySelectorAll(".house__preview-comment");function p(e){e?(o.removeAttribute("hidden"),u.removeAttribute("hidden")):(o.setAttribute("hidden",!0),u.setAttribute("hidden",!0))}function c(e){s.forEach(t=>{t.classList.contains("house__preview-comment--"+e)?t.removeAttribute("hidden"):t.setAttribute("hidden",!0)})}function v(){"YT embed"===i.type.value?(p(!0),c("embed")):(p(!1),c("source"))}function h(e){r.innerText=e.target.value}function m(e){return e.replace(/[^]+src="/,"").replace(/"[^]+$/,"")}function f(e){e?(a.removeAttribute("disabled"),a.value="Add Love"):(a.setAttribute("disabled",!0),a.value="Link not valid")}function b(e){f(!1);let t=e.target.value;if("image"===i.type.value)window.houseApp.preloadImage(t,()=>{d.innerHTML=`<img src="${t}" alt="preview">`,f(!0)});else if("video"===i.type.value)window.houseApp.preloadVideo(t,()=>{d.innerHTML=`<video class="video" autoplay muted loop src="${t}"></video>`,f(!0)});else if("YT embed"===i.type.value){const e=m(t),n=i.ratio.value;d.innerHTML=window.createYTEmbed(e,n,d),f(!0)}}function _(n){n.preventDefault();const{allMedia:o}=window.houseState,u=(function(){const e={id:"_"+Math.random().toString(36).substr(2,9),type:i.type.value,description:i.description.value,link:i.url.value};return"YT embed"===i.type.value&&(e.link=m(i.url.value),e.ratio=i.ratio.value),e})();o.push(u),t.update(e,o,()=>{alert("Love shared succesfullly"),i.reset(),d.innerHTML=""}),houseApp.buildAlbum()}window.houseApp.initNewLinkUI=function(){n.addEventListener("input",v),o.addEventListener("input",h),l.addEventListener("input",b),i.addEventListener("submit",_),v()}})();